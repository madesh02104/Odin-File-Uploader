<h2>Upload File</h2>

<form action="/files/upload" method="POST" enctype="multipart/form-data" id="uploadForm">
  <div class="form-group">
    <label for="file">Select File</label>
    <input type="file" id="file" name="file" required>
  </div>
  
  <div class="form-group">
    <label for="folder">Folder (Optional)</label>
    <select id="folder" name="folderId">
      <option value="">-- No Folder --</option>
      <% if(folders && folders.length > 0) { %>
        <% folders.forEach(folder => { %>
          <option value="<%= folder.id %>" <%= selectedFolder === folder.id ? 'selected' : '' %>><%= folder.name %></option>
        <% }) %>
      <% } %>
    </select>
  </div>
  
  <button type="submit" class="btn btn-primary">Upload</button>
  <a href="/files" class="btn">Cancel</a>
</form>

<script>
  // Ensure the form submits as POST
  document.getElementById('uploadForm').addEventListener('submit', function(e) {
    // Disable the submit button to prevent double submission
    const submitBtn = this.querySelector('button[type="submit"]');
    if (submitBtn) {
      submitBtn.disabled = true;
      submitBtn.innerText = 'Uploading...';
    }
  });
</script>
